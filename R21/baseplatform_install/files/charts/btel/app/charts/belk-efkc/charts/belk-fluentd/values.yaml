## ref: https://confluence.app.alcatel-lucent.com/display/plateng/HELM+Application+Deployment+-+LIFECYCLE#HELMApplicationDeployment-LIFECYCLE-RelocatableChart
### global registry
global:
  # This registry is used for fluentd image
  registry: csf-docker-delivered.repo.lab.pl.alcatel-lucent.com
  # This registry is used for kubectl image
  registry1: csf-docker-delivered.repo.lab.pl.alcatel-lucent.com
  seccompAllowedProfileNames: docker/default
  seccompDefaultProfileName: docker/default

  #you can add prefixes to pod and container names by providing values for below parameters
  #Provide lowercase alphanumeric characters, '-' or '.'
  #Consider suffixing the podNamePrefix and containerNamePrefix with either . or - for convenience
  podNamePrefix:
  containerNamePrefix:

  # Istio-related parameters
  istio:
    #Istio version defined at global level. Accepts version in numeric X.Y format. Ex. 1.4/1.5
    version: 1.4

  #If rbac.enabled is set to false, then it is mandatory to provide precreated Service account either at global level or at individual chart level. 
  rbac:
    enabled: true
  #User can specify the precreated global SA here
  serviceAccountName: ""

customResourceNames:
  #Provide lowercase alphanumeric characters, '-' or '.'
  resourceNameLimit: 63
  fluentdPod:
    #when fluentdContainerName is not provided,<containerprefix>-(fullname)-daemonset/statefulset would be used.
    #Fullname will be set to <ReleaseName>-<ChartName> by default.
    fluentdContainerName: ""
  #If job/container names are not provided, then default names would be generated by the chart in following format: 
  #For job name: <podprefix>-<ReleaseName>-<string related to job>
  #For job containernames: <containerprefix>-<string related to job>
  scaleinJob:
    name: ""
    postscaleinContainerName: ""
  deletePvcJob:
    name: ""
    deletePvcContainerName: ""

#This section allows to configure user defined name for pods and containers(For container this will take effect only when customResourceName is not provided for container)
# Options include:
# nameOverride: fullname would become <ReleaseName>-<nameOverride>
# fullnameOverride: fullname would become fullnameOverride
# If specified both, fullnameOverride would take the precedence.
nameOverride:
fullnameOverride:

#postscalein should be 0 to run postscalein job for cleaning up unused PVCs
postscalein: 0

fluentd:
  kind: DaemonSet
  image:  
    repo: elk_f
    tag: 1.11.1-20.08.0
  ImagePullPolicy: "IfNotPresent" 
  replicas: 1
  podManagementPolicy: Parallel
  updateStrategy:
    type: RollingUpdate
  statefulsetSuffix: "-statefulset"
  daemonsetSuffix: "-daemonset"

  #User can configure the precreated SA specifically for this chart here. SA specified here takes precedence over the SA specified in global.
  #If precreated SA is not provided at global and individual chart level and rbac.enabled is set to true, then rbac objects will be created by the chart.
  serviceAccountName: ""

  securityContext:
    # By default fluentd chart runs as root user for reading container logs.
    # When root privilege is disabled it runs as td-agent user with UID: 999 
    # fsGroup is the gid that is assigned for the volumemounts mounted to the pod(fsGroup ID is used for block storage)
    fsGroup: 998
    # The supplementalGroups ID applies to shared storage volumes. Uncomment below line to set supplemetary group.
    #supplementalGroups: [998]
    # Uncomment below lines lines to configure SELinux label to a container.
    # For more details refer to https://kubernetes.io/docs/tasks/configure-pod-container/security-context/
    #seLinuxOptions:
    #  level: "s0:c23,c123"
    privileged: False

  # Uncomment below lines to configure fluentd pod specific annotations. Use 6 space indentation
  #custom:
    #annotations:

  resources:
    limits:
      cpu: "1"
      memory: "1Gi"
    requests:
      cpu: "600m"
      memory: "500Mi"

#set the system name and system ID for non-container log messages
  EnvVars:
    system: "BCMT"
    systemId: "BCMT ID"

# if set to true fluentd container will run as root user and reads container, journal logs.
# setting it to false will run container as td-agent user and it will not read container, journal logs.
# Example- If kind is StatefulSet and you want to store the logs coming from kafka and you dont want to read any container/journal logs then set this flag to false.
# Donot change the flag unless required.
  enable_root_privilege: true
#set enabled as true if you want to add any certificate in fluentd configuration or if you want to use ssl for fluentd configuration while using SG.
#all the fluentd certificates will be present in "/etc/td-agent/certs"
#Make sure to use the same path in fluentd configuration with proper certificate names.
#Give certificate name and paste the base64 converted certificates or passwords in data section.
  fluentd_certificates:
    enabled: false
    data:
      #example
      #prometheus-crt.pem: <base64_root_ca_crt_pem>
      #prometheus-key.pem: <base64_root_ca_key_pem>
      #prometheus-root-ca.pem: <base64_root_ca_pem>
      #es-root-ca.pem: <base64_es_root_ca_pem>

#if you have created certificates in perticular namespace then edit host as elasticsearch.<namespace> in belk.conf present in fluentd-config/ directory
  #configurable values are belk, clog-json, clog-journal, custom-value
  fluentd_config: belk

  configFile: |
    #If you have own configuration for fluentd other than provided by belk/clog then set fluentd_config: custom-value and provide your configuration below. Example-
    #<source>
    #  @type tail
    #  path /var/log/test/*.log
    #  tag test
    #  pos_file /var/log/td-agent.pos
    #  format none
    #</source>
    #<match test>
    #  @type stdout
    #</match>

# set the enabled value to true if some service to be exposed from fluentd like fluentd-promethues-plugin which exports fluentd metrics so that prometheus can scrap the metrics via this service and port
# The below section added to enable/disable fluentd-prometheus service.
  service:
    enabled: false
    # if you want to provide your own name for service then provide the value in "custom_name"
    # Default value is template {{ "fullname" . }}
    # Delete the old chart and deploy new chart if you want to configure "custom_name" parameter. 
    custom_name: ""
    # type of service: None, ClusterIP
    type: ClusterIP
    # metricsPort is for getting fluentd prometheus metrics. 
    # 24231 is the default port of fluentd-prometheus-plugin.
    # If metricsPort is changed, update same port in fluentd-prometheus configuration in the respective .conf file and in the prometheus annotation below as well.
    metricsPort: 24231
    annotations: {}

# This section is added to enable/disable fluentd forward service.
  forward_service:
    enabled: false
    # if you want to provide your own name for service then provide the value in "custom_name"
    # Default value is template {{ "fullname" . }}-forwarder
    custom_name: ""
    # source port for forwarder
    port: 24224
    # type of service: None, ClusterIP
    type: ClusterIP
    annotations: {}

  # set to false in case of fluentd running as StatefulSet if you dont want to mount these directories.
  volume_mount_enable: true
  # fluentd volumes
  volumes:
    - name: varlog
      hostPath:
        path: /var/log
    - name: dockercontainers
      hostPath:
        path: /data0/docker
  # volume mounts
  volumeMounts:
    - name: varlog
      mountPath: /var/log
    - name: dockercontainers
      mountPath: /data0/docker
  
  ## Node labels for pod assignment
  ### ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector
  nodeSelector: {}

  ## Toleration is asking the K8S schedule to ignore a taint
  ### ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/
  tolerations: []

  livenessProbe:
    initialDelaySeconds: 30
    periodSeconds: 20
    timeoutSeconds: 1
    successThreshold: 1
    failureThreshold: 3
  readinessProbe:
    initialDelaySeconds: 30
    periodSeconds: 15
    timeoutSeconds: 1
    successThreshold: 1
    failureThreshold: 3

  ## Pod scheduling preferences.
  ## ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity
  affinity: {}

  #To configure cutomized labels to pods. Uncomment the below line and give labels after 4 space indentation
  #podLabels:
    #resourcetype: pod 

  persistence:
    #For 18.8 BCMT onwards storageClassName cinder will bydefault get picked up. For using the chart in BCMT-18.6 provide storageClassName which you have created.
    ##If you want to use local storage as volume give "local-storage" in storageClassName.
    storageClassName: ""
    accessMode: ReadWriteOnce
    size: 10Gi
    # set pvc_auto_delete to true if you want the persistent volume to also get deleted on deletion of the release.
    # This will delete all the previsous data stored in the persistent volume.
    # When local storage is used it will deleted only PVC not PV.
    pvc_auto_delete: false

cbur:
  enabled: true
  #the maximum copy you want to saved.
  maxCopy: 5
  #Modes supported now: "local","NETBKUP","AVAMAR","CEPHS3","AWSS3", case insensitive
  backendMode: "local"
  #It is used for scheduled backup task
  cronJob: "0 23 * * *"
  #Set below parameters to true for auto enabling cron job
  autoEnableCron: false
  #Set below parameter to true in case you want cronjob to be automatically deleted when autoEnableCron is set back to false from true
  autoUpdateCron: false

# Set to true to enable istio
istio:
  enabled: false
  #Istio version specified at chart level takes precedence over global level.
  #Accepts istio version in numeric X.Y format. Ex. 1.4/1.5
  version:

kubectl:
  image:
    repo: tools/kubectl
    tag: v1.14.10-nano
  jobResources:
    requests:
     cpu: 200m
     memory: 500Mi
    limits:
     cpu: 1
     memory: 1Gi

cvea_log:
  enable: false
  cvea_connection: 0.0.0.0:9991
  rpc_timeout: 300
  cvea_retrytimes: 10
  cvea_retryinterval: 200
