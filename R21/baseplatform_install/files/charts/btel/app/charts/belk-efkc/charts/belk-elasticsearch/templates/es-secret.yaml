{{- if .Values.searchguard.enable }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ template "elasticsearch.fullname" . }}
  labels:
    release: {{ .Release.Name | quote }} 
type: Opaque
data:
  {{- if not .Values.istio.enabled }}
  ## Start of custom modification of original chart for CSFID-2092
  #keystore.jks: {{ .Values.searchguard.base64Keystore }}
  keypass: {{ .Values.searchguard.base64KeystorePasswd }}
  #truststore.jks: {{ .Values.searchguard.base64Truststore }}
  trustpass: {{ .Values.searchguard.base64TruststorePasswd }}
  #client-keystore.jks: {{ .Values.searchguard.base64ClientKeystore }}
  {{- else }}
  keypass: Y2hhbmdlaXQ=
  trustpass: Y2hhbmdlaXQ=
  {{- end }}
  {{- if or (.Values.istio.enabled) (not .Values.searchguard.http_ssl) }}
  adminUsername: {{ .Values.searchguard.adminUsername }}
  adminPwd: {{ .Values.searchguard.adminPwd }}
  {{- else }}
  #admin.crt.pem: {{ .Values.searchguard.base64_client_cert }}
  #admin.key.pem: {{ .Values.searchguard.base64_client_key }}
  {{- end }}
  ## End of Custom modification of original chart
  {{- if (and (.Values.searchguard.keycloak_auth) (.Values.searchguard.base64_keycloak_rootca_pem)) }}
  keycloak-rootca.pem: {{ .Values.searchguard.base64_keycloak_rootca_pem }}
  {{- end }}
{{- end }}

