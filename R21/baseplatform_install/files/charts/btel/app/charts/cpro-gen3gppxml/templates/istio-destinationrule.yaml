{{- if .Values.istio.enable }}
apiVersion: networking.istio.io/v1alpha3
kind: DestinationRule
metadata:
  name: {{ template "gen3gppxml.fullname" . }}
  namespace: {{ .Release.Namespace }}
spec:
  # Start of custom modification of original chart for CSFS-31473
  host: "{{ template "gen3gppxml.fullname" . }}.{{ .Release.Namespace }}.{{ .Values.dns.domain }}"
  # End of custom modification of original chart for CSFS-31473
  trafficPolicy:
{{- if .Values.istio.mtls_enable }}
    tls:
      mode: ISTIO_MUTUAL
{{- else }}
    tls:
      mode: DISABLE
{{- end }}
{{- end }}

